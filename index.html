<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รพ.สต.คลองน้อย - บริการสุขภาพเพื่อชุมชน</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f8f9fa;
        }
        .header-bg {
            background: linear-gradient(135deg, #0f9b0f 0%, #006400 100%);
            color: white;
            padding: 3rem 0;
            margin-bottom: 2rem;
            border-bottom-left-radius: 50% 20px;
            border-bottom-right-radius: 50% 20px;
        }
        .card-custom {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            height: 100%;
        }
        .card-custom:hover {
            transform: translateY(-5px);
        }
        .api-badge {
            font-size: 0.8rem;
            background-color: #e9ecef;
            color: #495057;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .queue-list img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .pm-safe { color: #198754; }
        .pm-danger { color: #dc3545; }
        footer {
            background-color: #343a40;
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
        }
    </style>
</head>
<body>

    <header class="header-bg text-center">
        <div class="container">
            <h1 class="display-4 fw-bold">รพ.สต.คลองน้อย</h1>
            <p class="lead">ต.คลองน้อย อ.บ้านแพรก จ.พระนครศรีอยุธยา</p>
            <p>มุ่งมั่นพัฒนาคุณภาพชีวิต ยกระดับสาธารณสุขชุมชน | <strong>ปีงบประมาณ 2569</strong></p>
        </div>
    </header>

    <div class="container">
        
        <div class="row mb-5">
            <div class="col-md-8 mx-auto text-center">
                <h3>ยินดีต้อนรับสู่ระบบบริการข้อมูลสุขภาพ</h3>
                <p class="text-muted">ข้อมูลอัปเดตอัตโนมัติแบบ Real-time เพื่อการดูแลสุขภาพของพี่น้องชาวคลองน้อย</p>
            </div>
        </div>

        <div class="row g-4">
            
            <div class="col-md-4">
                <div class="card card-custom p-3">
                    <div class="card-body text-center">
                        <div class="mb-3 text-primary">
                            <i class="fas fa-temperature-high fa-3x"></i>
                        </div>
                        <h5 class="card-title">สภาพอากาศวันนี้</h5>
                        <p class="small text-muted">พิกัด: อ.บ้านแพรก อยุธยา</p>
                        <hr>
                        <h2 id="temp-display" class="fw-bold">กำลังโหลด...</h2>
                        <p id="weather-desc">กำลังประมวลผล</p>
                        <div class="mt-3">
                            <span class="api-badge">Source: Open-Meteo API</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card card-custom p-3">
                    <div class="card-body text-center">
                        <div class="mb-3 text-success">
                            <i class="fas fa-lungs fa-3x"></i>
                        </div>
                        <h5 class="card-title">ดัชนีคุณภาพอากาศ (PM 2.5)</h5>
                        <p class="small text-muted">สถานีตรวจวัด: อยุธยา</p>
                        <hr>
                        <h2 id="aqi-display" class="fw-bold">กำลังโหลด...</h2>
                        <p id="aqi-status">รอสักครู่</p>
                        <div class="mt-3">
                            <span class="api-badge">Source: WAQI API</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card card-custom p-3">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="card-title m-0"><i class="fas fa-users-medical text-danger"></i> คิวรับบริการล่าสุด</h5>
                            <span class="badge bg-danger">สด</span>
                        </div>
                        <p class="small text-muted">(จำลองข้อมูลผู้ป่วยเพื่อการสาธิต)</p>
                        <hr>
                        <ul class="list-group list-group-flush queue-list" id="queue-container">
                            <li class="list-group-item text-center">กำลังดึงข้อมูลคิว...</li>
                        </ul>
                        <div class="mt-3 text-center">
                            <span class="api-badge">Source: RandomUser API</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="row mt-5">
            <div class="col-12">
                <div class="alert alert-info" role="alert">
                    <h5 class="alert-heading"><i class="fas fa-bullhorn"></i> ประชาสัมพันธ์ ปี 2569</h5>
                    <p>รพ.สต.คลองน้อย เปิดให้บริการฉีดวัคซีนป้องกันไข้หวัดใหญ่สายพันธุ์ใหม่ สำหรับผู้สูงอายุ 60 ปีขึ้นไป และกลุ่มเสี่ยงโรคเรื้อรัง ทุกวันพุธ เวลา 08.30 - 12.00 น.</p>
                    <hr>
                    <p class="mb-0">ติดต่อฉุกเฉิน: 1669 หรือ โทรศัพท์ รพ.สต. 035-XXX-XXX</p>
                </div>
            </div>
        </div>

    </div>

    <footer class="text-center">
        <div class="container">
            <p>&copy; 2569 โรงพยาบาลส่งเสริมสุขภาพตำบลคลองน้อย อ.บ้านแพรก จ.พระนครศรีอยุธยา</p>
            <small class="text-muted">พัฒนาโดย: ระบบอัตโนมัติ (Demo Project)</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // 1. Fetch Weather Data (Open-Meteo)
        // พิกัด อ.บ้านแพรก อยุธยา ประมาณ: 14.64, 100.58
        async function fetchWeather() {
            try {
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=14.64&longitude=100.58&current_weather=true');
                const data = await response.json();
                
                const temp = data.current_weather.temperature;
                const wind = data.current_weather.windspeed;
                
                document.getElementById('temp-display').innerText = `${temp} °C`;
                document.getElementById('weather-desc').innerText = `ลมแรง: ${wind} กม./ชม. (ดูแลสุขภาพช่วงอากาศเปลี่ยนแปลง)`;
            } catch (error) {
                document.getElementById('temp-display').innerText = "N/A";
            }
        }

        // 2. Fetch Air Quality (WAQI)
        // ใช้ Demo Token (ในงานจริงควรสมัคร Key ฟรีที่ waqi.info)
        async function fetchAirQuality() {
            try {
                // ค้นหาสถานีในอยุธยา (ใช้ geo search หรือระบุสถานี)
                const response = await fetch('https://api.waqi.info/feed/ayutthaya/?token=demo'); 
                const data = await response.json();
                
                if (data.status === 'ok') {
                    const aqi = data.data.aqi;
                    const display = document.getElementById('aqi-display');
                    const status = document.getElementById('aqi-status');
                    
                    display.innerText = aqi;

                    if (aqi <= 50) {
                        display.className = "fw-bold pm-safe";
                        status.innerText = "อากาศดีมาก เหมาะแก่การออกกำลังกาย";
                    } else if (aqi <= 100) {
                        display.className = "fw-bold text-warning";
                        status.innerText = "ปานกลาง ควรเฝ้าระวัง";
                    } else {
                        display.className = "fw-bold pm-danger";
                        status.innerText = "มีผลกระทบต่อสุขภาพ ควรสวมหน้ากาก";
                    }
                }
            } catch (error) {
                document.getElementById('aqi-display').innerText = "-";
                document.getElementById('aqi-status').innerText = "ไม่สามารถดึงข้อมูลได้";
            }
        }

        // 3. Fetch Queue Simulation (RandomUser)
        // จำลองรายชื่อผู้ป่วยรอคิวตรวจ
        async function fetchQueue() {
            try {
                const response = await fetch('https://randomuser.me/api/?results=4&nat=us,gb'); // ใช้ nat=th ไม่ได้ในบางครั้ง จึงใช้สากลแล้วสมมติเอา
                const data = await response.json();
                
                const listContainer = document.getElementById('queue-container');
                listContainer.innerHTML = ''; // Clear loading text

                data.results.forEach((user, index) => {
                    const li = document.createElement('li');
                    li.className = 'list-group-item d-flex align-items-center';
                    
                    // สุ่มประเภทการรักษา
                    const types = ['รับยาโรคเบาหวาน', 'ทำแผล', 'ฉีดวัคซีน', 'ตรวจโรคทั่วไป'];
                    const randomType = types[Math.floor(Math.random() * types.length)];
                    
                    li.innerHTML = `
                        <div class="fw-bold me-2">#00${index + 1}</div>
                        <img src="${user.picture.thumbnail}" alt="user">
                        <div class="flex-grow-1">
                            <div class="fw-bold" style="font-size:0.9rem;">คุณ ${user.name.first}</div>
                            <small class="text-muted">${randomType}</small>
                        </div>
                        <span class="badge bg-light text-dark">รอเรียก</span>
                    `;
                    listContainer.appendChild(li);
                });

            } catch (error) {
                document.getElementById('queue-container').innerHTML = '<li class="list-group-item text-danger">โหลดข้อมูลคิวล้มเหลว</li>';
            }
        }

        // เรียกใช้งานฟังก์ชันเมื่อโหลดหน้าเว็บ
        window.onload = function() {
            fetchWeather();
            fetchAirQuality();
            fetchQueue();
        };
    </script>
</body>
</html>
